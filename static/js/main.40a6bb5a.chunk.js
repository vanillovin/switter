(this.webpackJsonpswitter=this.webpackJsonpswitter||[]).push([[0],{71:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var c=n(8),a=n.n(c),o=n(43),i=n.n(o),r=n(13),s=n(29),l=n(19),d=n(1),u=n.n(d),j=n(3),b=n(54),m=n(26),f=n(14),O=n(33),h=(Object(b.a)({apiKey:"AIzaSyBOtqn8Rj-gLsv9CJm8F3dZKXyhey4x9Zw",authDomain:"switter-b2db8.firebaseapp.com",projectId:"switter-b2db8",storageBucket:"switter-b2db8.appspot.com",messagingSenderId:"132047093499",appId:"1:132047093499:web:315645c2fe687228ab3a5e"}),Object(m.d)()),v=Object(f.g)(),p=Object(O.c)(),x=n(20),g=n(39),w=n(6),k=n(12),N=function(e){return Object(m.h)(h.currentUser,e)},C=function(e,t){return Object(f.h)(Object(f.f)(v,"users","profileData"),e,t)},S=function(e,t){var n=Object(f.d)(v,"users");return Object(f.k)(Object(f.f)(n,"profilePhoto"),Object(w.a)({},e,t))},y=function(e,t){var n=Object(f.d)(v,"users");return Object(f.k)(Object(f.f)(n,"profileData"),Object(w.a)({},e,t))},U=n(2),A="https://firebasestorage.googleapis.com/v0/b/switter-b2db8.appspot.com/o/logo.png?alt=media&token=d636781d-a94b-4b3f-8b18-374cceacf61d",P=function(e,t){return{email:e,aboutMe:"",displayName:"\u2665",photoURL:t,writtenSweets:[],commentedSweets:[],likesSweets:[]}},M=function(){var e=Object(c.useState)({email:"",password:""}),t=Object(r.a)(e,2),n=t[0],a=t[1],o=n.email,i=n.password,s=Object(c.useState)(""),l=Object(r.a)(s,2),d=l[0],b=l[1],f=Object(c.useState)(!0),O=Object(r.a)(f,2),v=O[0],p=O[1],x=function(e){var t=e.target,c=t.name,o=t.value;a(Object(k.a)(Object(k.a)({},n),{},Object(w.a)({},c,o)))},g=function(){var e=Object(j.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,!v){e.next=6;break}Object(m.c)(h,o,i).then((function(e){var t=e.user.uid;S(t,A).catch((function(e){console.log("updateUsersProfilePhoto err",e)})),y(t,P(o,A)).catch((function(e){return console.log("updateUsersProfileData err",e)}))})),e.next=8;break;case 6:return e.next=8,Object(m.f)(h,o,i);case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("AuthForm onSubmit error :",e.t0,"error.message :",e.t0.message),b(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("form",{onSubmit:g,className:"container",children:[Object(U.jsx)("input",{name:"email",type:"email",placeholder:"Email",required:!0,value:o,onChange:x,className:"authInput"}),Object(U.jsx)("input",{name:"password",type:"password",placeholder:"Password",required:!0,value:i,onChange:x,className:"authInput"}),Object(U.jsx)("input",{type:"submit",className:"authInput authSubmit",value:v?"\uac00\uc785\ud558\uae30":"\ub85c\uadf8\uc778"}),d&&Object(U.jsx)("span",{className:"authError",children:d})]}),Object(U.jsx)("span",{onClick:function(){p((function(e){return!e}))},className:"authSwitch",children:v?"\ub85c\uadf8\uc778\ud558\uae30":"\uc774\uba54\uc77c\ub85c \uac00\uc785\ud558\uae30"})]})},D=function(e){var t=e.darkMode,n=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.name,e.prev=1,"google"!==n){e.next=8;break}return c=new m.b,e.next=6,Object(m.g)(h,c);case 6:e.next=12;break;case 8:if("github"!==n){e.next=12;break}return c=new m.a,e.next=12,Object(m.g)(h,c);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(U.jsxs)("div",{className:t?"authContainer dark":"authContainer",children:[Object(U.jsx)(x.a,{icon:g.c,color:"#9775fa",size:"3x",style:{marginBottom:30}}),Object(U.jsx)(M,{}),Object(U.jsxs)("div",{className:"authBtns",children:[Object(U.jsxs)("button",{onClick:n,name:"google",className:"authBtn",children:["Google\ub85c \ub85c\uadf8\uc778"," ",Object(U.jsx)(x.a,{icon:g.b,color:"#fff",style:{marginLeft:2}})]}),Object(U.jsxs)("button",{onClick:n,name:"github",className:"authBtn",children:["Github\ub85c \ub85c\uadf8\uc778"," ",Object(U.jsx)(x.a,{icon:g.a,color:"#fff",style:{marginLeft:2}})]})]})]})},I=n(17),L=n(24),F=function(e,t){var n="https://vanillovin.github.io/switter";if("twitter"===e)window.open("https://twitter.com/intent/tweet?text=".concat("Switter","&url=").concat(n,"/%23/sweet/").concat(t),"popup\uc81c\ubaa9","width=500, height=400, scrollbars=yes");else{if("facebook"!==e)return;window.open("http://www.facebook.com/sharer/sharer.php?u=".concat(n,"/%23/sweet/").concat(t))}};function _(e){var t=(new Date-e)/1e3;if(t<60)return"\ubc29\uae08 \uc804";var n=t/60;if(n<60)return"".concat(Math.floor(n),"\ubd84 \uc804");var c=n/60;if(c<24)return"".concat(Math.floor(c),"\uc2dc\uac04 \uc804");var a=c/24;if(a<7)return"".concat(Math.floor(a),"\uc77c \uc804");var o=a/7;if(o<5)return"".concat(Math.floor(o),"\uc8fc \uc804");var i=a/30;if(i<12)return"".concat(Math.floor(i),"\uac1c\uc6d4 \uc804");var r=a/365;return"".concat(Math.floor(r),"\ub144 \uc804")}var B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Object(c.useState)(e),n=Object(r.a)(t,2),a=n[0],o=n[1],i=function(e){return o(e.target.value)},s=function(){return o("")};return{value:a,setValue:function(e){return o(e)},onChangeValue:i,onClearValue:s}};var R=function(e){var t=e.text,n=e.onSubmit,c=e.closeEdit,a=B(t),o=a.value,i=a.onChangeValue;return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("form",{className:"container sweetEdit",onSubmit:function(e){e.preventDefault(),n(o)},children:[Object(U.jsx)("textarea",{className:"formInput",type:"text",placeholder:"\uc2a4\uc717 \uc218\uc815\ud558\uae30",name:"sweet",required:!0,autoFocus:!0,value:o,onChange:i,maxLength:500}),Object(U.jsx)("input",{type:"submit",value:"\uc2a4\uc717 \uc5c5\ub370\uc774\ud2b8",className:"formBtn"})]}),Object(U.jsx)("button",{onClick:c,className:"formBtn cancelBtn",children:"\ucde8\uc18c"})]})},E=n(27),T=n(49),V=n(55);var z=function(e){var t=Object(c.useState)(!1),n=Object(r.a)(t,2),a=n[0],o=n[1],i=function(t){var n;(null===(n=e.current)||void 0===n?void 0:n.contains(t.target))||o(!1)};return Object(c.useEffect)((function(){return a&&document.addEventListener("mousedown",i),function(){document.addEventListener("mousedown",i)}}),[a]),[a,function(){return o((function(e){return!e}))}]};var q=function(e){var t=e.type,n=e.id,a=e.likes,o=e.liked,i=e.comments,s=e.handleLikeSweet,l=e.handleAddComment,d=Object(c.useRef)(),u=z(d),j=Object(r.a)(u,2),b=j[0],m=j[1];return Object(U.jsxs)("div",{className:"bottom b".concat(t),children:[Object(U.jsx)("button",{title:"\ub9c8\uc74c\uc5d0 \ub4e4\uc5b4\uc694",onClick:s,children:"detail"!==t?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(L.d,{color:o?"#e05d5d":""}),Object(U.jsx)("span",{children:" ".concat(a.length)})]}):o?Object(U.jsx)(T.a,{}):Object(U.jsx)(T.b,{})}),Object(U.jsxs)("button",{title:"\ub2f5\uae00",onClick:l,children:[Object(U.jsx)(L.a,{}),"detail"!==t&&Object(U.jsx)("span",{children:" ".concat(i.length)})]}),Object(U.jsxs)("div",{className:"toggles",ref:d,title:"\uacf5\uc720\ud558\uae30",children:[Object(U.jsx)("button",{className:"shareBtn",onClick:m,children:Object(U.jsx)(L.f,{})}),b&&Object(U.jsxs)("div",{title:"\ub9c1\ud06c \ubcf5\uc0ac\ud558\uae30",className:"buttons",children:[Object(U.jsxs)("button",{onClick:function(){return e=n,navigator.clipboard.writeText("https://vanillovin.github.io/switter/#/sweet/".concat(e)),void alert("\ud074\ub9bd\ubcf4\ub4dc\ub85c \ubcf5\uc0ac\ub410\uc2b5\ub2c8\ub2e4");var e},children:[Object(U.jsx)(V.a,{})," \uc2a4\uc717 \ub9c1\ud06c \ubcf5\uc0ac\ud558\uae30"]}),Object(U.jsxs)("button",{title:"\ud2b8\uc704\ud130\uc5d0 \uacf5\uc720\ud558\uae30",onClick:function(){return F("twitter",n)},children:[Object(U.jsx)(L.i,{})," \ud2b8\uc704\ud130\uc5d0 \uacf5\uc720\ud558\uae30"]}),Object(U.jsxs)("button",{title:"\ud398\uc774\uc2a4\ubd81\uc5d0 \uacf5\uc720\ud558\uae30",onClick:function(){return F("facebook",n)},children:[Object(U.jsx)(L.c,{})," \ud398\uc774\uc2a4\ubd81\uc5d0 \uacf5\uc720\ud558\uae30"]})]})]})]})},J=function(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)("im modal content"),i=Object(r.a)(o,2),s=i[0],l=i[1];return{modal:n,handleModal:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a((function(e){return!e})),e&&l(e)},openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a(!0),e&&l(e)},closeModal:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a(!1),e&&l(e)},modalContent:s}},G=n(74),K=function(e,t){return Object(f.h)(Object(f.j)(Object(f.d)(Object(f.g)(),"sweets"),Object(f.i)("createdAt","desc")),e,t)},W=function(e,t,n){return Object(f.h)(Object(f.f)(v,"sweets/".concat(e)),t,n)},Z=function(e){return Object(f.a)(Object(f.d)(v,"sweets"),e)},X=function(){var e=Object(j.a)(u.a.mark((function e(t,n){var c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=Object(O.d)(p,"".concat(t,"/").concat(Object(G.a)())),e.next=4,Object(O.e)(c,n,"data_url");case 4:return a=e.sent,e.abrupt("return",Object(O.b)(a.ref));case 8:e.prev=8,e.t0=e.catch(0),console.log("imageFileUploadAndDownload err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=Object(j.a)(u.a.mark((function e(t,n){var c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=Object(O.d)(p,"".concat(t,"/profileImage")),e.next=4,Object(O.e)(c,n,"data_url");case 4:return a=e.sent,e.next=7,Object(O.b)(a.ref);case 7:return e.abrupt("return",e.sent);case 10:e.prev=10,e.t0=e.catch(0),console.log("sweets - profileImageFileUploadAndDownload err",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),H=function(e){return Object(O.a)(Object(O.d)(p,e))},Q=function(e){return Object(f.e)(Object(f.f)(v,"sweets/".concat(e)))},Y=function(e,t,n){return e?Object(f.k)(Object(f.f)(v,"sweets/".concat(t)),{likes:Object(f.b)(n)}):Object(f.k)(Object(f.f)(v,"sweets/".concat(t)),{likes:Object(f.c)(n)})},ee=function(e,t){return Object(f.k)(Object(f.f)(v,"sweets/".concat(e)),{text:t})},te=function(e,t){return Object(f.k)(Object(f.f)(v,"sweets/".concat(e)),{comments:Object(f.c)(t)})},ne=function(e,t){return Object(f.k)(Object(f.f)(v,"sweets/".concat(e)),{comments:t})},ce=function(e,t){return Object(f.k)(Object(f.f)(v,"sweets/".concat(e.id)),{comments:e.comments.filter((function(e){return e.createdAt!==t}))})};var ae=function(e){var t=e.nestedComments,n=e.isOwner,c=e.handleAddNestedComment,a=e.handleDeleteNestedComment,o=B(),i=o.value,r=o.onChangeValue,s=o.onClearValue,l=function(e){e.preventDefault(),c(i,s)};return Object(U.jsxs)("div",{className:"nestedCommentsContainer",children:[Object(U.jsx)("form",{className:"commentForm",onSubmit:l,children:Object(U.jsxs)("div",{className:"commentInput__container",children:[Object(U.jsx)("input",{className:"commentInput__input",type:"text",name:"comment",value:i,onChange:r,placeholder:"\ub313\uae00 \ub2ec\uae30",required:!0}),Object(U.jsx)("input",{className:"commentInput__arrow",type:"submit",value:"\u2192",onSubmit:l})]})}),Object(U.jsx)("div",{className:"comments",children:null===t||void 0===t?void 0:t.map((function(e){return Object(U.jsxs)("div",{children:[Object(U.jsxs)("div",{className:"hello",children:[Object(U.jsxs)("div",{className:"info",children:[Object(U.jsx)("span",{className:"dname",children:e.name||"\u2665"}),Object(U.jsx)("span",{className:"mini",children:_(e.createdAt)})]}),n&&Object(U.jsx)("button",{className:"delcommentBtn",onClick:function(){return a(e.createdAt)},children:Object(U.jsx)(L.g,{})})]}),Object(U.jsx)("div",{className:"ctext",children:e.text})]},e.createdAt)}))})]})},oe=Object(c.createContext)(),ie=function(e){var t=e.children,n=Object(c.useState)({loading:!0,data:null,error:!1}),a=Object(r.a)(n,2),o=a[0],i=a[1],s=Object(c.useState)(),l=Object(r.a)(s,2),d=l[0],u=l[1];return Object(c.useEffect)((function(){var e,t;e=function(e){u(e.data())},t=function(e){console.log("fetchUsersProfilePhoto error",e)},Object(f.h)(Object(f.f)(v,"users","profilePhoto"),e,t),C((function(e){i((function(t){return Object(k.a)(Object(k.a)({},t),{},{loading:!1,data:e.data()})}))}),(function(e){console.log("fetchUsersProfileData error",e),i((function(t){return Object(k.a)(Object(k.a)({},t),{},{loading:!1,error:e})}))}))}),[]),Object(U.jsx)(oe.Provider,{value:{usersProfilePhoto:d,usersProfileData:o},children:t})};var re=function(e){var t=e.comments,n=e.comment,a=e.userObj,o=e.handleDeleteComment,i=J(),r=i.modal,s=i.handleModal,l=n.uid===a.uid,d=Object(c.useContext)(oe).usersProfileData.data,u=null===d||void 0===d?void 0:d[a.uid];return Object(U.jsxs)("div",{className:"comment",children:[Object(U.jsxs)("div",{className:"hello",children:[Object(U.jsxs)("div",{className:"info",children:[Object(U.jsx)("span",{className:"dname",children:n.name||"\u2665"}),Object(U.jsx)("span",{className:"mini",children:_(n.createdAt)})]}),l&&Object(U.jsx)("button",{className:"delcommentBtn",onClick:function(){return o(n.createdAt)},children:Object(U.jsx)(x.a,{icon:E.f})})]}),Object(U.jsx)("div",{className:"ctext",children:n.text}),Object(U.jsx)(q,{type:"comment",id:"id",likes:n.likes,liked:new Set(n.likes).has(a.uid),comments:n.nestedComments,handleLikeSweet:function(){var e=new Set(n.likes).has(a.uid),c=t.map((function(t){return t.createdAt===n.createdAt?Object(k.a)(Object(k.a)({},n),{},{likes:e?n.likes.filter((function(e){return e!==a.uid})):[].concat(Object(I.a)(n.likes),[a.uid])}):t}));ne(n.id,c).then((function(t){console.log("handleLikeComment res",t),y(a.uid,Object(k.a)(Object(k.a)({},u),{},{likesSweets:e?u.likesSweets.filter((function(e){return e.id!==n.id})):[].concat(Object(I.a)(u.likesSweets),[n])})).then((function(e){console.log("updateProfileLikesComments res",e)})).catch((function(e){console.log("updateProfileLikesComments err",e)}))})).catch((function(e){console.log("handleLikeComment err",e)}))},handleAddComment:s}),r&&Object(U.jsx)(ae,{nestedComments:n.nestedComments.sort((function(e,t){return t.createdAt-e.createdAt})),isOwner:l,handleAddNestedComment:function(e,c){var o={commentId:n.createdAt,id:n.id,createdAt:Date.now(),uid:a.uid,dName:a.displayName,text:e},i=t.map((function(e){return e.createdAt===n.createdAt?Object(k.a)(Object(k.a)({},n),{},{nestedComments:[].concat(Object(I.a)(n.nestedComments),[o])}):e}));ne(n.id,i).then((function(e){c(),y(null===a||void 0===a?void 0:a.uid,Object(k.a)(Object(k.a)({},u),{},{commentedSweets:[].concat(Object(I.a)(u.commentedSweets),[o])})).then((function(e){console.log("updateUsersCommentedSweets res",e)})).catch((function(e){console.log("updateUsersCommentedSweets err",e)}))})).catch((function(e){console.log("updateSweetNestedComment err",e)}))},handleDeleteNestedComment:function(e){if(window.confirm("\ub2f5\uae00\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){var c=t.map((function(t){return t.createdAt===n.createdAt?Object(k.a)(Object(k.a)({},n),{},{nestedComments:n.nestedComments.filter((function(t){return t.createdAt!==e}))}):t}));ne(n.id,c).then((function(t){y(a.uid,Object(k.a)(Object(k.a)({},u),{},{commentedSweets:u.commentedSweets.filter((function(t){return t.createdAt!==e}))})).then((function(e){console.log("updateUsersCommentedSweets res",e)})).catch((function(e){console.log("updateUsersCommentedSweets err",e)}))})).catch((function(e){console.log("deleteSweetNestedComment err",e)}))}}})]},n.createdAt)};var se=function(e){var t=e.handleAddComment,n=e.handleDeleteComment,c=e.comments,a=e.userObj,o=B(),i=o.value,r=o.onChangeValue,s=o.onClearValue,l=function(e){e.preventDefault(),t(i,s)};return Object(U.jsx)("div",{className:"comments-container",children:Object(U.jsxs)("div",{style:{marginTop:10},children:[Object(U.jsx)("form",{className:"commentForm",onSubmit:l,children:Object(U.jsxs)("div",{className:"commentInput__container",children:[Object(U.jsx)("input",{className:"commentInput__input",type:"text",name:"comment",value:i,onChange:r,placeholder:"\ub313\uae00 \ub2ec\uae30",required:!0}),Object(U.jsx)("input",{className:"commentInput__arrow",type:"submit",value:"\u2192",onSubmit:l})]})}),Object(U.jsx)("div",{className:"comments",children:null===c||void 0===c?void 0:c.map((function(e){return Object(U.jsx)(re,{comments:c,comment:e,userObj:a,handleDeleteComment:n},e.createdAt)}))})]})})},le=function(e){var t=e.userObj,n=e.sweet,a=e.isOwner,o=e.darkMode,i=Object(l.g)(),s=n.comments.sort((function(e,t){return t.createdAt-e.createdAt})),d=Object(c.useState)(!1),u=Object(r.a)(d,2),j=u[0],b=u[1],m=Object(c.useState)(!1),f=Object(r.a)(m,2),O=f[0],h=f[1],v=Object(c.useContext)(oe),p=v.usersProfileData.data,x=v.usersProfilePhoto,g=null===p||void 0===p?void 0:p[null===n||void 0===n?void 0:n.creatorId],w=null===x||void 0===x?void 0:x[null===n||void 0===n?void 0:n.creatorId],N=function(e){e.target===e.currentTarget&&i.push("/sweet/".concat(null===n||void 0===n?void 0:n.id))};return Object(U.jsx)("div",{className:o?"sweet dark":"sweet",onClick:N,children:j?Object(U.jsx)(R,{text:n.text,onSubmit:function(e){ee(n.id,e).then((function(c){b(!1),y(t.uid,Object(k.a)(Object(k.a)({},g),{},{likesSweets:g.likesSweets.map((function(t){return t.id===n.id?Object(k.a)(Object(k.a)({},t),{},{text:e}):t})),writtenSweets:g.writtenSweets.map((function(t){return t.id===n.id?Object(k.a)(Object(k.a)({},t),{},{text:e}):t}))}))})).catch((function(e){console.log("updateSweet err",e)}))},closeEdit:function(){return b(!1)}}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("div",{className:"hello",children:[Object(U.jsxs)("div",{className:"info",onClick:function(){return i.push("/profile/".concat(n.creatorId))},children:[Object(U.jsx)("img",{alt:"profile",src:w||"".concat("/switter","/default-profile.png")}),Object(U.jsx)("span",{className:"dname",children:n.dName||"\u2665"}),Object(U.jsx)("span",{className:"mini",children:_(n.createdAt)})]}),a&&Object(U.jsxs)("div",{className:"sweet__actions",children:[Object(U.jsx)("span",{onClick:function(){window.confirm("\uc2a4\uc717\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(""!==n.attachmentUrl&&H(n.attachmentUrl).catch((function(e){console.log("deleteStorageFile err",e)})),Q(n.id).then((function(e){y(t.uid,Object(k.a)(Object(k.a)({},g),{},{likesSweets:g.likesSweets.filter((function(e){return e.id!==n.id})),commentedSweets:g.commentedSweets.filter((function(e){return e.id!==n.id})),writtenSweets:g.writtenSweets.filter((function(e){return e.id!==n.id}))})).catch((function(e){console.log("updateUsersProfileData delComment err",e)}))})).catch((function(e){console.log("deleteSweet err",e)})))},children:Object(U.jsx)(L.h,{})}),Object(U.jsx)("span",{onClick:function(){return b((function(e){return!e}))},children:Object(U.jsx)(L.e,{})})]})]}),Object(U.jsx)("p",{className:"sweet__text",onClick:N,children:n.text}),n.attachmentUrl&&Object(U.jsx)("img",{alt:"img",src:n.attachmentUrl,onClick:N}),Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(q,{type:"sweet",id:n.id,likes:n.likes,liked:new Set(n.likes).has(t.uid),comments:n.comments,handleLikeSweet:function(){var e=new Set(n.likes).has(t.uid);Y(e,n.id,t.uid).then((function(c){y(t.uid,Object(k.a)(Object(k.a)({},g),{},{likesSweets:e?g.likesSweets.filter((function(e){return e.id!==n.id})):[].concat(Object(I.a)(g.likesSweets),[n])})).then((function(e){console.log("updateProfileLikesSweets res",e)})).catch((function(e){console.log("updateProfileLikesSweets err",e)}))})).catch((function(e){console.log("likeSweet err",e)}))},handleAddComment:function(){return h((function(e){return!e}))}}),O&&Object(U.jsx)(se,{handleAddComment:function(e,c){var a={id:n.id,uid:t.uid,createdAt:Date.now(),dName:t.displayName,text:e,likes:[],nestedComments:[]};te(n.id,a).then((function(e){c(),y(t.uid,Object(k.a)(Object(k.a)({},g),{},{commentedSweets:[].concat(Object(I.a)(g.commentedSweets),[a])})).then((function(e){console.log("updateUsersCommentedSweets res",e)})).catch((function(e){console.log("updateUsersCommentedSweets err",e)}))})).catch((function(e){console.log("addSweetComment err",e)}))},handleDeleteComment:function(e){window.confirm("\ub313\uae00\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&ce(n,e).then((function(n){y(t.uid,Object(k.a)(Object(k.a)({},g),{},{commentedSweets:g.commentedSweets.filter((function(t){return t.createdAt!==e})).filter((function(t){return t.commentId!==e}))})).then((function(e){console.log("updateUsersCommentedSweets delete res",e)})).catch((function(e){console.log("updateUsersCommentedSweets delete err",e)}))})).catch((function(e){return console.log("deleteSweetComment err",e)}))},comments:s,userObj:t})]})]})})},de=function(e){var t=e.userObj,n=e.darkMode,a=Object(c.useContext)(oe).usersProfileData.data,o=null===a||void 0===a?void 0:a[t.uid],i=B(""),r=i.value,s=i.onChangeValue,l=i.onClearValue,d=B(""),b=d.value,m=d.setValue,f=d.onClearValue,O=function(){var e=Object(j.a)(u.a.mark((function e(n){var c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""!==r){e.next=3;break}return e.abrupt("return");case 3:if(c="",""===b){e.next=8;break}return e.next=7,X(t.uid,b);case 7:c=e.sent;case 8:a={text:r,createdAt:Date.now(),creatorId:t.uid,attachmentUrl:c,dName:t.displayName,email:t.email,likes:[],comments:[]},Z(a).then((function(e){l(),f(),y(t.uid,Object(k.a)(Object(k.a)({},o),{},{writtenSweets:[].concat(Object(I.a)(o.writtenSweets),[Object(k.a)({id:e.id},a)])})).then((function(e){console.log("updateUserProfileArrData writtenSweets res",e)})).catch((function(e){console.log("updateUserProfileArrData writtenSweets err",e)}))})).catch((function(e){console.log("createSweet err",e)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(U.jsxs)("form",{onSubmit:O,className:n?"factoryForm dark":"factoryForm",children:[Object(U.jsxs)("div",{className:"factoryInput__container",children:[Object(U.jsx)("input",{className:"factoryInput__input",value:r,onChange:s,type:"text",placeholder:"\ubb34\uc2a8 \ub2ec\ucf64\ud55c \uc0dd\uac01\uc744 \ud558\uace0 \uc788\ub098\uc694?",maxLength:120}),Object(U.jsx)("input",{type:"submit",value:"\u2192",className:"factoryInput__arrow",onSubmit:onsubmit})]}),Object(U.jsxs)("label",{htmlFor:"attach-file",className:"factoryInput__label",children:[Object(U.jsx)("span",{children:"\uc0ac\uc9c4 \uc120\ud0dd\ud558\uae30"}),Object(U.jsx)(x.a,{icon:E.e})]}),Object(U.jsx)("input",{id:"attach-file",type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0],n=new FileReader;n.onloadend=function(e){var t=e.currentTarget.result;m(t)},n.readAsDataURL(t)},style:{opacity:0}}),b&&Object(U.jsxs)("div",{className:"factoryForm__attachment",children:[Object(U.jsx)("img",{alt:"img",src:b,style:{backgroundImage:b}}),Object(U.jsxs)("div",{className:"factoryForm__clear",onClick:f,children:[Object(U.jsx)("span",{children:"\uc81c\uac70\ud558\uae30"}),Object(U.jsx)(x.a,{icon:E.f})]})]})]})};var ue=function(){return Object(U.jsxs)("div",{className:"loading-component",children:[Object(U.jsx)("div",{className:"loading"}),Object(U.jsx)("p",{children:"loading..."})]})},je={loading:!0,data:null,error:null};var be=function(e){var t=e.userObj,n=e.darkMode,a=Object(c.useState)(je),o=Object(r.a)(a,2),i=o[0],s=o[1],l=i.loading,d=i.data;return i.error,Object(c.useEffect)((function(){return K((function(e){var t=e.docs.map((function(e){return Object(k.a)({id:e.id},e.data())}));s((function(e){return Object(k.a)(Object(k.a)({},e),{},{loading:!1,data:t})}))}),(function(e){console.log("fetchSweets error",e),s((function(t){return Object(k.a)(Object(k.a)({},t),{},{loading:!1,error:e})}))})),function(){K(),s(je)}}),[]),l?Object(U.jsx)(ue,{}):Object(U.jsxs)("div",{className:n?"container dark":"container",children:[Object(U.jsx)(de,{userObj:t,darkMode:n}),Object(U.jsx)("div",{className:"sweet-container",style:{marginTop:30},children:null===d||void 0===d?void 0:d.map((function(e){return Object(U.jsx)(le,{userObj:t,sweet:e,isOwner:e.creatorId===t.uid,darkMode:n},e.id)}))})]})},me=function(e){var t=e.userObj,n=e.darkMode,c=e.onDarkMode;return Object(U.jsx)("nav",{className:n?"nav dark":"nav",children:Object(U.jsxs)("ul",{style:{display:"flex",justifyContent:"center"},children:[Object(U.jsx)("li",{className:"logo",children:Object(U.jsxs)(s.b,{to:"/",className:"navlink",activeClassName:"",children:[Object(U.jsx)(x.a,{icon:g.c,size:"2x"}),Object(U.jsx)("span",{children:"\u2665"})]})}),Object(U.jsx)("li",{className:"home",children:Object(U.jsxs)(s.b,{to:"/",className:"navlink",activeClassName:"",children:[Object(U.jsx)(x.a,{icon:E.c,size:"2x"}),Object(U.jsx)("span",{children:"home"})]})}),Object(U.jsx)("li",{className:"profile",children:Object(U.jsxs)(s.b,{className:"navlink",activeClassName:"",to:"/profile/".concat(t.uid),children:[Object(U.jsx)(x.a,{icon:E.g,size:"2x"}),Object(U.jsx)("span",{children:t.displayName||"\u2665"})]})}),Object(U.jsx)("li",{className:"msg",children:Object(U.jsxs)(s.b,{to:"/msg",className:"navlink",activeClassName:"active",children:[Object(U.jsx)(x.a,{icon:E.b,size:"2x"}),Object(U.jsx)("span",{children:"+1"})]})}),Object(U.jsxs)("li",{className:"dark navlink",onClick:c,children:[Object(U.jsx)(x.a,{icon:E.d,size:"2x",color:n?"#e9c77b":"#000000cc"}),Object(U.jsx)("span",{children:n?"light":"dark"})]}),Object(U.jsx)("li",{className:"more navlink",children:Object(U.jsx)(x.a,{icon:E.a,size:"2x"})})]})})},fe=n(42);var Oe=function(e){var t=e.photoURL,n=e.displayName,c=e.aboutMe,a=e.onSubmit,o=e.onCloseEdit,i=B(t),r=i.value,s=i.setValue,l=B(n),d=l.value,u=l.onChangeValue,j=B(c),b=j.value,m=j.onChangeValue,f=function(e){e.preventDefault(),a(r,d,b)};return Object(U.jsxs)("form",{onSubmit:f,children:[Object(U.jsxs)("div",{className:"editProfileImage",children:[Object(U.jsx)("img",{alt:"profile",className:"profileImage",src:r||"".concat("/switter","/default-profile.png")}),Object(U.jsx)("label",{htmlFor:"attach-file",className:"",children:Object(U.jsx)("span",{children:"\uc0ac\uc9c4 \uc120\ud0dd\ud558\uae30"})}),Object(U.jsx)("input",{id:"attach-file",type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0],n=new FileReader;n&&void 0!==t&&null!==t&&(n.onload=function(e){var t=e.target.result;s(t)},n.readAsDataURL(t))},style:{display:"none",opacity:0}}),r!==t&&Object(U.jsx)("button",{className:"profileImgclearBtn",onClick:function(){return s(t)},children:Object(U.jsx)("span",{children:"\uc81c\uac70\ud558\uae30"})})]}),Object(U.jsx)("input",{onChange:u,type:"text",placeholder:"Display name",value:d||"",className:"formInput"}),Object(U.jsx)("input",{onChange:m,type:"text",placeholder:"About Me",value:b||"",className:"formInput aboutMeInput"}),Object(U.jsx)("input",{type:"submit",className:"formBtn updateProfileBtn",onClick:f,value:"\ud504\ub85c\ud544 \uc5c5\ub370\uc774\ud2b8"}),Object(U.jsx)("input",{type:"button",className:"formBtn updateProfileBtn",onClick:o,style:{background:"rgba(177,151,252,0.6)"},value:"\ucde8\uc18c\ud558\uae30"})]})};var he=function(e){var t=e.message,n=void 0===t?"\uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \ud398\uc774\uc9c0\uc785\ub2c8\ub2e4":t,c=Object(l.g)();return Object(U.jsxs)("div",{className:"notFound",children:[Object(U.jsx)("h1",{children:n}),Object(U.jsx)("button",{onClick:function(){return c.push("/")},children:"\ud648\uc73c\ub85c \ub3cc\uc544\uac00\uae30"})]})},ve=function(e){var t=e.children,n=document.getElementById("modal");return i.a.createPortal(t,n)};var pe=function(){var e=Object(c.useRef)(),t=Object(c.useContext)(xe),n=t.modal,a=t.modalContent,o=t.closeModal;return n?Object(U.jsx)(ve,{children:Object(U.jsx)("div",{className:"modal-container",onClick:function(e){e.target===e.currentTarget&&o()},ref:e,children:Object(U.jsxs)("div",{className:"modal",children:[Object(U.jsx)("h1",{children:"Ooops"}),Object(U.jsx)("p",{children:a}),Object(U.jsx)("button",{className:"closeBtn",onClick:function(){return o()},children:"\ub2eb\uae30"})]})})}):null},xe=Object(c.createContext)(),ge=function(e){var t=e.children,n=J(),c=n.modal,a=n.handleModal,o=n.openModal,i=n.closeModal,r=n.modalContent;return Object(U.jsxs)(xe.Provider,{value:{modal:c,handleModal:a,openModal:o,closeModal:i,modalContent:r},children:[Object(U.jsx)(pe,{}),t]})};var we=function(e){var t=e.sweets,n=e.profilePhoto,c=Object(l.g)();return Object(U.jsx)("div",{className:"timelineSweetcontainer",children:t.length>0?t.sort((function(e,t){return t.createdAt-e.createdAt})).map((function(e){return Object(U.jsxs)("div",{className:"sweet",onClick:function(t){t.target===t.currentTarget&&c.push("/sweet/".concat(null===e||void 0===e?void 0:e.id))},children:[Object(U.jsx)("div",{className:"hello",children:Object(U.jsxs)("div",{className:"info",onClick:function(t){t.target===t.currentTarget&&c.push("/profile/".concat(null===e||void 0===e?void 0:e.uid))},children:[Object(U.jsx)("img",{alt:"profile",src:n}),Object(U.jsx)("span",{className:"dname",children:e.dName||"\u2665"}),Object(U.jsx)("span",{className:"mini",children:_(e.createdAt)})]})}),Object(U.jsx)("p",{className:"sweet__text",onClick:function(t){t.target===t.currentTarget&&c.push("/sweet/".concat(null===e||void 0===e?void 0:e.id))},children:e.text}),e.attachmentUrl&&Object(U.jsx)("img",{alt:"img",src:e.attachmentUrl,onClick:function(t){t.target===t.currentTarget&&c.push("/sweet/".concat(null===e||void 0===e?void 0:e.id))}})]},e.createdAt)})):Object(U.jsx)("p",{className:"nothing",children:"\uc544\uc9c1 \uc544\ubb34\uac83\ub3c4 \uc5c6\uc2b5\ub2c8\ub2e4"})})},ke=function(e){var t=e.refreshUser,n=e.userObj,a=e.darkMode,o=Object(l.h)(),i=Object(l.g)(),s=Object(c.useContext)(oe).usersProfilePhoto,d=null===s||void 0===s?void 0:s[o.uid],b=Object(c.useState)({loading:!0,data:null,error:!1}),m=Object(r.a)(b,2),f=m[0],O=m[1],v=f.loading,p=f.data,x=f.error,g=null===p||void 0===p?void 0:p[o.uid],w=Object(c.useState)(!1),A=Object(r.a)(w,2),P=A[0],M=A[1],D=n.uid===o.uid,I=Object(c.useContext)(xe).handleModal,L=null===i||void 0===i?void 0:i.location.pathname;Object(c.useEffect)((function(){return C((function(e){O((function(t){return Object(k.a)(Object(k.a)({},t),{},{loading:!1,data:e.data()})}))}),(function(e){console.log("fetchUsersProfileData error",e),O((function(t){return Object(k.a)(Object(k.a)({},t),{},{loading:!1,error:e})}))})),function(){C()}}),[null===o||void 0===o?void 0:o.uid]);var F=function(){var e=Object(j.a)(u.a.mark((function e(c,a,o){var i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.displayName!==a||n.photoURL!==c||g.aboutMe!==o){e.next=3;break}return M(!1),e.abrupt("return");case 3:if(i=null===g||void 0===g?void 0:g.photoURL,c===(null===g||void 0===g?void 0:g.photoURL)){e.next=8;break}return e.next=7,$(n.uid,c);case 7:i=e.sent;case 8:N({displayName:a,photoURL:i}).then((function(e){console.log("Profile update!",e),M(!1),t(),S(null===n||void 0===n?void 0:n.uid,i).catch((function(e){console.log("Profile - updateUsersProfilePhoto err",e)})),y(null===n||void 0===n?void 0:n.uid,Object(k.a)(Object(k.a)({},g),{},{displayName:a,aboutMe:o,photoURL:i})).catch((function(e){console.log("Profile - updateUsersProfileData err",e)}))})).catch((function(e){console.log("Profile update An error occurred",e),I("\ud68c\uc6d0\ub2d8\uc758 \ud504\ub85c\ud544\uc744 \uc5c5\ub370\uc774\ud2b8\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694")}));case 9:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}();return v?Object(U.jsx)(ue,{}):g?x?Object(U.jsx)(he,{message:"\uc0ac\uc6a9\uc790\ub97c \uc870\ud68c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4"}):Object(U.jsxs)("div",{className:a?"profileContainer dark":"profileContainer",children:[Object(U.jsx)("div",{className:"profileInfoContainer",children:P?Object(U.jsx)(Oe,{photoURL:null===g||void 0===g?void 0:g.photoURL,displayName:n.displayName,aboutMe:null===g||void 0===g?void 0:g.aboutMe,onSubmit:F,onCloseEdit:function(){return M(!1)}}):Object(U.jsxs)("div",{className:"profileInfo",children:[Object(U.jsxs)("div",{children:[Object(U.jsx)("img",{alt:"profile",className:"profileImage",src:(null===g||void 0===g?void 0:g.photoURL)||"".concat("/switter","/default-profile.png")}),Object(U.jsxs)("div",{children:[Object(U.jsx)("h2",{className:"dname",children:null===g||void 0===g?void 0:g.displayName}),Object(U.jsxs)("p",{className:"email",children:["@",null===g||void 0===g?void 0:g.email.split("@")[0]]})]}),Object(U.jsx)("p",{className:"aboutMe",children:null===g||void 0===g?void 0:g.aboutMe})]}),D&&Object(U.jsxs)("div",{className:"profileBtns",children:[Object(U.jsx)("button",{className:"profileEditButton",onClick:function(){return M(!0)},children:"\ud504\ub85c\ud544 \uc218\uc815"}),Object(U.jsx)("button",{className:"logoutBtn",onClick:function(){Object(fe.h)(h),i.push("/")},children:"\ub85c\uadf8\uc544\uc6c3"})]})]})}),Object(U.jsxs)("div",{children:[Object(U.jsx)("ul",{className:"profileTimeline",children:[["","\uc2a4\uc717"],["/comments","\ub313\uae00"],["/likes","\ub9c8\uc74c\uc5d0 \ub4e4\uc5b4\uc694"]].map((function(e,t){var n=Object(r.a)(e,2),c=n[0],a=n[1];return Object(U.jsx)("li",{style:{fontWeight:(0===t?!L.split("/")[3]:L.includes(c))?"bold":""},to:"/profile/".concat(o.uid).concat(c),onClick:function(){return i.push("/profile/".concat(o.uid).concat(c))},children:a},t)}))}),Object(U.jsxs)(l.d,{children:[Object(U.jsx)(l.b,{exact:!0,path:"/profile/".concat(o.uid),children:Object(U.jsx)(we,{sweets:null===g||void 0===g?void 0:g.writtenSweets,profilePhoto:d})}),Object(U.jsx)(l.b,{exact:!0,path:"/profile/".concat(o.uid,"/comments"),children:Object(U.jsx)(we,{sweets:null===g||void 0===g?void 0:g.commentedSweets,profilePhoto:d})}),Object(U.jsx)(l.b,{exact:!0,path:"/profile/".concat(o.uid,"/likes"),children:Object(U.jsx)(we,{sweets:null===g||void 0===g?void 0:g.likesSweets,profilePhoto:d})})]})]})]}):Object(U.jsx)(he,{message:"\uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \uc0ac\uc6a9\uc790\uc785\ub2c8\ub2e4"})},Ne=["\ub204\uad70\uac00\ub97c \uc0ac\ub791\ud558\uace0\uc790 \ud55c\ub2e4\uba74 \ub108 \uc790\uc2e0\uc744 \uba3c\uc800 \uc0ac\ub791\ud574\uc57c \ud574","\uc55e\uc774 \ubcf4\uc774\uc9c0 \uc54a\uc744 \ub54c\ub294 \uc9c0\uae08 \ud560 \uc218 \uc788\ub294 \uc77c\uc744 \ud558\uba74 \ub3fc","\uc9c4\uc815\ud55c \uc544\ub984\ub2e4\uc6c0\uc740 \ub0b4\uba74\uc5d0 \uc788\uc5b4","\uadf8\ub807\uac8c \uad6c\uacbd\ub9cc \ud558\ub2e4\uac00\ub294 \ub124 \uc778\uc0dd\uc774 \ub108 \uc5c6\uc774 \ud758\ub7ec\uac00\ub294 \uac78 \uad6c\uacbd\ud558\uac8c \ub420\uac78","\ub9c8\uc74c\ub9cc\uc744 \uac00\uc9c0\uace0 \uc788\uc5b4\uc11c\ub294 \uc548 \ub41c\ub2e4. \ubc18\ub4dc\uc2dc \uc2e4\ucc9c\ud574\uc57c \ud55c\ub2e4","\uc18c\uc2ec\ud574\uc9c8 \uc2dc\uac04 \uc5c6\uc5b4 \uc6a9\uac10\ud558\uace0 \ub300\ub2f4\ud558\uac8c \ud574","\uae30\uc5b5\ud574 \ub108\ub294 \uc138\uc0c1\uc744 \ube5b\uc73c\ub85c \uac00\ub4dd \ucc44\uc6b8 \uc218 \uc788\ub294 \uc874\uc7ac\ub780 \uac78","\uc0ac\ub791\uc740 \ub204\uad70\uac00\ub97c \ub098\ubcf4\ub2e4 \uba3c\uc800 \ub450\ub294 \uac70\uc57c","\uc6a9\uae30\ub97c \ub0b4","\ud589\uc6b4\uc744 \ube4c\uc5b4","\ub108\uc5d0\uac8c\ub294 \uc544\uc9c1 \uafc8\uc744 \uc774\ub8e8\uae30 \uc704\ud55c \ucda9\ubd84\ud55c \uc2dc\uac04\uc774 \uc788\uc5b4","\ud798\ub0b4. \uc778\uc0dd\uc740 \ud55c\uc21c\uac04\uc5d0 \ubc14\ub00c\uae30\ub3c4 \ud558\ub294 \uac70\ub2c8\uae4c","\ud070 \ud76c\ub9dd\uc774 \ud070 \uc0ac\ub78c\uc744 \ub9cc\ub4e0\ub2e4","\uac00\ub054\uc740 \uc633\uc740 \uae38\uc774 \uac00\uc7a5 \uc26c\uc6b4 \uae38\uc774 \uc544\ub2d0 \ub54c\ub3c4 \uc788\uc9c0","\uc808\ub300\ub85c \uace0\uac1c\ub97c \ub5a8\uad6c\uc9c0 \ub9d0\ub77c \uace0\uac1c\ub97c \uce58\ucf1c\ub4e4\uace0 \uc138\uc0c1\uc744 \ub611\ubc14\ub85c \ubcf4\ub77c","\uc2dc\uac04\uc740 \uc544\ubb34\ub3c4 \uae30\ub2e4\ub824\uc8fc\uc9c0 \uc54a\uc544","\uc544\ub984\ub2e4\uc6c0\uc740 \uc0ac\ub77c\uc838 \ubc84\ub9ac\uc9c0\ub9cc \ub9c8\uc74c\uc5d0\uc11c \uc6b0\ub7ec\ub098\ub294 \uac83\uc740 \uc0ac\ub77c\uc9c0\uc9c0 \uc54a\uc544. \uc720\uba38, \uce5c\uc808\ud568, \uc6a9\uae30","\uc911\uc694\ud55c \uac74 \uac89\ubaa8\uc2b5\uc774 \uc544\ub2cc \ub9c8\uc74c\uc774\uc57c","\uac04\uc808\ud788 \ubc14\ub77c\ub294 \ub9c8\uc74c\uc774 \uc788\uc5b4\uc57c \ub9c8\ubc95\uc774 \uc77c\uc5b4\ub0a0 \uc218 \uc788\uc5b4","\uc5ed\uacbd\uc744 \uc774\uaca8\ub0b4\uace0 \ud540 \uaf43\uc774 \uac00\uc7a5 \uc544\ub984\ub2e4\uc6b4 \uaf43\uc774\ub780\ub2e4","\ub208\uc744 \uac10\uc9c0 \ub9d0\uace0 \ub611\ubc14\ub85c \ubd10. \ub450\ub824\uc6c0\uc758 \uc2e4\uccb4\ub294 \uc0dd\uac01\uacfc \ub2e4\ub97c \uc218 \uc788\uc5b4","\uc80a\uac8c \uc0ac\ub294 \uac74 \uc808\ub300 \ub2a6\uc740 \ub098\uc774\ub780 \uc5c6\uc5b4","\ub110 \uc5b5\ub204\ub974\ub358 \uac83\ub4e4\uc774 \ub110 \uc77c\uc73c\ucf1c \uc904 \uac70\uc57c","\ud589\ubcf5\uc774 \ub124\uac00 \uc788\ub294 \uacf3\uc5d0 \uc788\ub2e4\ub294 \uac78 \uae68\ub2eb\uac8c \ub418\ub294 \ub0a0\uc774 \uc62c \uac70\uc57c","\ub204\uad6c\ub4e0 \ubb34\uc5c7\uc774\ub4e0 \ub420 \uc218 \uc788\uc5b4","\ub108\uc758 \uac00\uc871\uc774 \ub110 \uc5bc\ub9c8\ub098 \uc0ac\ub791\ud558\ub294\uc9c0 \uc78a\uc9c0 \ub9c8","\uc775\uc219\ud55c \uacf3\uc744 \ubc97\uc5b4\ub098\uc11c \ubaa8\ud5d8\ud574","\uc778\uc0dd\uc740 \uac00\ub2a5\uc131\uc73c\ub85c \uac00\ub4dd \ucc28 \uc788\uc5b4","\ub9e4\uc77c \ud589\ubcf5\ud560 \uc21c \uc5c6\uc9c0\ub9cc, \ud589\ubcf5\ud55c \uac83\ub4e4\uc740 \ub9e4\uc77c \uc788\uc5b4","\ucd5c\uace0\uc758 \uc21c\uac04\uc740 \uac11\uc790\uae30 \ucc3e\uc544\uc624\ub294 \uac70\uc57c"],Ce=function(e){var t=e.userName,n=Object(c.useState)(!0),a=Object(r.a)(n,2),o=a[0],i=a[1],s=Object(c.useState)("".concat(t||"hey"," \ud074\ub9ad\ud574\ubd10 :)")),l=Object(r.a)(s,2),d=l[0],u=l[1],j=function(){return i(!o)};return Object(U.jsx)("div",{className:"container",children:Object(U.jsxs)("div",{className:"msg-container",children:[Object(U.jsx)("div",{className:"msgh",children:Object(U.jsx)("span",{children:"Message"})}),o?Object(U.jsx)("div",{className:"msgs",onClick:j,children:Object(U.jsxs)("div",{className:"chat",children:[Object(U.jsxs)("div",{style:{fontWeight:"bold",marginBottom:12},children:[Object(U.jsx)(x.a,{icon:E.g})," ","\uc775\uba85"]}),Object(U.jsx)("span",{children:d})]})}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("div",{className:"back",onClick:j,children:o?"":"\u2190"}),Object(U.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:20},children:[Object(U.jsx)("div",{style:{marginRight:10},children:Object(U.jsx)(x.a,{icon:E.g,color:"black"})}),Object(U.jsx)("div",{className:"mymsg",onClick:function(){return u(Ne[Math.floor(Math.random()*Ne.length)])},children:Object(U.jsx)("span",{children:d})})]})]})]})})},Se=/[\s\uFEFF\xA0]+$/gi,ye={loading:!0,data:null,error:null};var Ue=function(e){var t,n,a,o=e.userObj,i=e.darkMode,s=Object(c.useState)(ye),d=Object(r.a)(s,2),u=d[0],j=d[1],b=u.loading,m=u.data,f=(u.error,Object(c.useRef)()),O=Object(l.h)(),h=Object(l.g)(),v=Object(c.useState)(!1),p=Object(r.a)(v,2),x=p[0],g=p[1],w=z(f),N=Object(r.a)(w,2),C=N[0],S=N[1],A=(null===m||void 0===m?void 0:m.creatorId)===o.uid,P=Object(c.useContext)(oe),M=P.usersProfilePhoto,D=P.usersProfileData.data,F=null===D||void 0===D?void 0:D[null===o||void 0===o?void 0:o.uid];return Object(c.useEffect)((function(){return W(O.id,(function(e){j((function(t){return Object(k.a)(Object(k.a)({},t),{},{loading:!1,data:e.data()})}))}),(function(e){console.log("fetchSweet error",e),j((function(t){return Object(k.a)(Object(k.a)({},t),{},{loading:!1,error:e})}))})),function(){W(),j(ye)}}),[O.id]),b?Object(U.jsx)(ue,{}):m?Object(U.jsxs)("div",{className:i?"sweetDetailContainer dark":"sweetDetailContainer",children:[Object(U.jsxs)("div",{className:"sweetDetailTop",children:[Object(U.jsx)("button",{onClick:function(){return h.push("/")},children:"\u2190"}),"\uc2a4\ub808\ub4dc"]}),Object(U.jsxs)("div",{className:"sweetDetail",children:[x?Object(U.jsx)(R,{text:null===m||void 0===m?void 0:m.text,onSubmit:function(e){ee(null===O||void 0===O?void 0:O.id,e).then((function(t){g(!1),y(null===o||void 0===o?void 0:o.uid,Object(k.a)(Object(k.a)({},F),{},{likesSweets:F.likesSweets.map((function(t){return t.id===(null===O||void 0===O?void 0:O.id)?Object(k.a)(Object(k.a)({},t),{},{text:e}):t})),writtenSweets:F.writtenSweets.map((function(t){return t.id===(null===O||void 0===O?void 0:O.id)?Object(k.a)(Object(k.a)({},t),{},{text:e}):t}))}))})).catch((function(e){console.log("updateSweet err",e)}))},closeEdit:function(){return g(!1)}}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("div",{className:"sweetDetailTopInfo",children:[Object(U.jsxs)("div",{className:"userInfo",onClick:function(){return h.push("/profile/".concat(null===m||void 0===m?void 0:m.creatorId))},children:[Object(U.jsx)("img",{alt:"profile",className:"profile",src:M[m.creatorId]||"".concat("/switter","/default-profile.png")}),Object(U.jsxs)("div",{className:"text",children:[Object(U.jsx)("span",{className:"dname",children:(null===m||void 0===m?void 0:m.dName)||"\u2665"}),Object(U.jsxs)("span",{className:"email",children:["@",null===m||void 0===m||null===(t=m.email)||void 0===t?void 0:t.split("@")[0]]})]})]}),Object(U.jsx)("div",{className:"rightButtons",ref:f,children:A&&Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("button",{className:"rToggleBtn",onClick:S,children:Object(U.jsx)(L.b,{})}),C&&Object(U.jsxs)("div",{className:"buttons",children:[Object(U.jsxs)("button",{onClick:function(){window.confirm("\uc2a4\uc717\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(""!==(null===m||void 0===m?void 0:m.attachmentUrl)&&H(m.attachmentUrl).catch((function(e){console.log("deleteStorageFile err",e)})),Q(null===O||void 0===O?void 0:O.id).then((function(e){h.goBack(),y(null===o||void 0===o?void 0:o.uid,Object(k.a)(Object(k.a)({},F),{},{likesSweets:F.likesSweets.filter((function(e){return e.id!==(null===O||void 0===O?void 0:O.id)})),commentedSweets:F.commentedSweets.filter((function(e){return e.id!==(null===O||void 0===O?void 0:O.id)})),writtenSweets:F.writtenSweets.filter((function(e){return e.id!==(null===O||void 0===O?void 0:O.id)}))})).catch((function(e){console.log("updateUsersProfileData delComment err",e)}))})).catch((function(e){console.log("deleteSweet err",e)})))},children:[Object(U.jsx)(L.h,{})," \uc0ad\uc81c\ud558\uae30"]}),Object(U.jsxs)("button",{onClick:function(){return g((function(e){return!e}))},children:[Object(U.jsx)(L.e,{})," \uc218\uc815\ud558\uae30"]})]})]})})]}),Object(U.jsx)("p",{className:"sweetDetailContent",children:null===m||void 0===m?void 0:m.text.replace(Se,"")}),(null===m||void 0===m?void 0:m.attachmentUrl)&&Object(U.jsx)("img",{alt:"img",src:null===m||void 0===m?void 0:m.attachmentUrl})]}),Object(U.jsxs)("div",{className:"sweetDetailInfo",children:[Object(U.jsxs)("div",{className:"commentText",children:[Object(U.jsx)("span",{children:null===m||void 0===m||null===(n=m.comments)||void 0===n?void 0:n.length})," \ub2f5\uae00"]}),Object(U.jsxs)("div",{children:[Object(U.jsx)("span",{children:null===m||void 0===m||null===(a=m.likes)||void 0===a?void 0:a.length})," \ub9c8\uc74c\uc5d0 \ub4e4\uc5b4\uc694"]})]}),Object(U.jsx)(q,{type:"detail",id:O.id,likes:m.likes,liked:m.likes.includes(null===o||void 0===o?void 0:o.uid),comments:m.comments,handleLikeSweet:function(){var e=new Set(null===m||void 0===m?void 0:m.likes).has(null===o||void 0===o?void 0:o.uid);Y(e,null===O||void 0===O?void 0:O.id,null===o||void 0===o?void 0:o.uid).then((function(t){y(null===o||void 0===o?void 0:o.uid,Object(k.a)(Object(k.a)({},F),{},{likesSweets:e?F.likesSweets.filter((function(e){return e.id!==m.id})):[].concat(Object(I.a)(F.likesSweets),[m])})).then((function(e){console.log("updateProfileLikesSweets res",e)})).catch((function(e){console.log("updateProfileLikesSweets err",e)}))})).catch((function(e){console.log("likeSweet err",e)}))},handleAddComment:function(){}}),Object(U.jsx)(se,{handleAddComment:function(e,t){var n={id:O.id,uid:null===o||void 0===o?void 0:o.uid,createdAt:Date.now(),dName:null===o||void 0===o?void 0:o.displayName,text:e,likes:[],nestedComments:[]};te(O.id,n).then((function(e){t(),y(o.uid,Object(k.a)(Object(k.a)({},F),{},{commentedSweets:[].concat(Object(I.a)(F.commentedSweets),[n])})).then((function(e){console.log("updateUsersCommentedSweets res",e)})).catch((function(e){console.log("updateUsersCommentedSweets err",e)}))})).catch((function(e){console.log("addSweetComment err",e)}))},handleDeleteComment:function(e){window.confirm("\ub313\uae00\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&ce(Object(k.a)(Object(k.a)({},m),{},{id:null===O||void 0===O?void 0:O.id}),e).then((function(t){y(null===o||void 0===o?void 0:o.uid,Object(k.a)(Object(k.a)({},F),{},{commentedSweets:F.commentedSweets.filter((function(t){return t.createdAt!==e})).filter((function(t){return t.commentId!==e}))})).then((function(e){console.log("updateUsersCommentedSweets delete res",e)})).catch((function(e){console.log("updateUsersCommentedSweets delete err",e)}))})).catch((function(e){return console.log("deleteSweetComment err",e)}))},comments:null===m||void 0===m?void 0:m.comments.sort((function(e,t){return t.createdAt-e.createdAt})),userObj:o})]})]}):Object(U.jsx)(he,{message:"\uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \uc2a4\uc717\uc785\ub2c8\ub2e4"})},Ae=function(e){var t=e.refreshUser,n=e.isLoggedIn,c=e.userObj,a=e.darkMode,o=e.onDarkMode;return Object(U.jsx)(s.a,{children:Object(U.jsx)(l.d,{children:Object(U.jsx)(U.Fragment,{children:Object(U.jsxs)("div",{className:a?"test dark":"test",children:[Object(U.jsx)("div",{className:a?"left dark":"left",children:n&&Object(U.jsx)(me,{userObj:c,darkMode:a,onDarkMode:o})}),n?Object(U.jsxs)("div",{className:a?"right dark":"right",children:[Object(U.jsx)(l.b,{exact:!0,path:"/",children:Object(U.jsx)(be,{userObj:c,darkMode:a,onDarkMode:o})}),Object(U.jsx)(l.b,{exact:!0,path:"/sweet/:id",children:Object(U.jsx)(Ue,{userObj:c,darkMode:a})}),Object(U.jsx)(l.b,{exact:!0,path:"/profile/:uid",children:Object(U.jsx)(ke,{userObj:c,refreshUser:t,darkMode:a})}),Object(U.jsx)(l.b,{exact:!0,path:"/profile/:uid/*",children:Object(U.jsx)(ke,{userObj:c,refreshUser:t,darkMode:a})}),Object(U.jsx)(l.b,{exact:!0,path:"/msg",children:Object(U.jsx)(Ce,{userName:c.displayName})})]}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(l.b,{exact:!0,path:"/",children:Object(U.jsx)(D,{darkMode:a})}),Object(U.jsx)(l.a,{from:"*",to:"/"})]})]})})})})};var Pe=function(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)(null),i=Object(r.a)(o,2),s=i[0],l=i[1],d=Object(c.useState)(!1),u=Object(r.a)(d,2),j=u[0],b=u[1];return Object(c.useEffect)((function(){Object(m.e)(h,(function(e){l(e?{email:e.email,displayName:e.displayName,uid:e.uid,photoURL:e.photoURL,updateProfile:function(t){return e.updateProfile(t)}}:null),a(!0)}))}),[]),console.log("App user",s),Object(U.jsx)(ie,{children:Object(U.jsx)(ge,{children:n?Object(U.jsx)(Ae,{refreshUser:function(){var e=h.currentUser;l({email:e.email,displayName:e.displayName,uid:e.uid,photoURL:e.photoURL,updateProfile:function(t){return e.updateProfile(t)}})},isLoggedIn:Boolean(s),userObj:s,darkMode:j,onDarkMode:function(){document.body.style=j?"background-color: #fff8e5":"background-color: #193446",b(!j)}}):Object(U.jsx)("div",{style:{marginTop:10},children:"Initializing...."})})})},Me=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,75)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),o(e),i(e)}))};n(71);i.a.render(Object(U.jsx)(a.a.StrictMode,{children:Object(U.jsx)(Pe,{})}),document.getElementById("root")),Me()}},[[72,1,2]]]);
//# sourceMappingURL=main.40a6bb5a.chunk.js.map